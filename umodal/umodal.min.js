$(document).ready(function(){function c(){$("body").removeClass("umodal-disable-scroll").css({paddingRight:0}),$(".umodal").css({paddingRight:0}),$(window).scrollTop(umodalScrollTop)}$("body").on("click",".umodal__open",function(o){o.preventDefault();var l=window.innerWidth-$(document).width();window.umodalScrollTop=$(window).scrollTop(),$("body").addClass("umodal-disable-scroll").css({paddingRight:l,top:-umodalScrollTop}),$(".umodal").css({paddingRight:l});var a=$(this).attr("umodal-id"),d=$(this).attr("umodal-src"),t=$(this).attr("href"),e=$(this).attr("umodal-content"),n=$(this).attr("umodal-class"),s=$(this).attr("umodal-accept");if(null!=t)t.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jpg|jpeg|png|bmp|gif|webp|ico|svg)((\?|#).*)?$)/i);$('<div class="umodal umodal_loading"><div class="umodal__inner"><button class="umodal__close"></button><div class="umodal__content"></div></div></div>').appendTo("body").hide().fadeIn(200);var u=$(".umodal__content");if(null!=a&&null!=a){$(".umodal").removeClass("umodal_loading").addClass("umodal_"+a);var i=$($('[umodal-id="'+a+'"]:not(.umodal__open)').parents()[0]);$('[umodal-id="'+a+'"]:not(.umodal__open)').appendTo(u),$(".umodal__close, .umodal__shut").on("click",function(){$(".umodal").fadeOut(200,function(){$(".umodal__content [umodal-id]").appendTo(i),$(this).remove(),c()})})}else{if(null==d)$(".umodal").addClass("umodal_inverse umodal_image"),u.html('<img src="'+t+'" class="umodal__image">'),$(".umodal__image").on("load",function(){$(this).addClass("umodal__image_show"),setTimeout(function(){$(".umodal").removeClass("umodal_loading")},50)}).on("error",function(){u.html("Не удалось загрузить изображение").fadeIn(200),$(".umodal").removeClass("umodal_loading")});else if(null!=e)u.hide().load(d+" "+e,function(o,l,a){"error"==l&&$(this).html("Не удалось загрузить содержимое: "+a.status+" "+a.statusText),$(this).fadeIn(200),setTimeout(function(){$(".umodal").removeClass("umodal_loading")},50)});else{var m;switch(u.hide(),s){case"json":m={accept:"application/json"};break;case"xml":m={accept:"application/xml"};break;default:m={accept:"text/html"}}$.ajax({url:d,type:"GET",headers:m,success:function(o){var l=JSON.stringify(o);s||null==o.match("<body[^>]*>")||(l=o.replace(/\r\n|\r|\n/g,"").match("<body[^>]*>(.*?)</body>")[0]),u.html(l).fadeIn(200),$(".umodal").removeClass("umodal_loading")},error:function(o){$(".umodal").removeClass("umodal_loading"),u.html("Не удалось загрузить содержимое").fadeIn(200)}})}$(".umodal__close, .umodal__shut").click(function(){$(".umodal").fadeOut(200,function(){$(this).remove(),c()})})}null!=n&&$(".umodal").addClass(n),setTimeout(function(){for(var o=$(".umodal__inner *").length;-1<o;o--)"auto"==$($(".umodal__inner *")[o]).css("overflow")&&$($(".umodal__inner *")[o]).addClass("umodal__item-scrollable");$("body").on("touchmove",function(o){$(this).hasClass("umodal-disable-scroll")&&o.preventDefault()}),$(".umodal-disable-scroll").on("touchstart",".umodal__item-scrollable",function(o){0===o.currentTarget.scrollTop?o.currentTarget.scrollTop=1:o.currentTarget.scrollHeight===o.currentTarget.scrollTop+o.currentTarget.offsetHeight&&(o.currentTarget.scrollTop-=1)}),$(".umodal-disable-scroll").on("touchmove",".umodal__item-scrollable",function(o){o.stopPropagation()})},250),$(".umodal__close").attr("title","[Esc]")}),$(document).keyup(function(o){27===o.keyCode&&$(".umodal__close, .umodal__shut").click()})});
