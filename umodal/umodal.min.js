$(document).ready(function(){function o(){$("body").removeClass("umodal-disable-scroll").css({paddingRight:0}),$(".umodal").css({paddingRight:0}),$(window).scrollTop(umodalScrollTop)}$(".umodal__open").on("click",function(l){l.preventDefault();var a=window.innerWidth-$(document).width();window.umodalScrollTop=$(window).scrollTop(),setTimeout(function(){$("body").addClass("umodal-disable-scroll").css({paddingRight:a,top:-umodalScrollTop}),$(".umodal").css({paddingRight:a})},200);var d=$(this).attr("umodal-id"),e=$(this).attr("umodal-src"),t=$(this).attr("href"),n=$(this).attr("umodal-content");if(null!=t)t.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jpg|jpeg|png|bmp|gif|webp|ico|svg)((\?|#).*)?$)/i);$('<div class="umodal umodal_loading"><div class="umodal__inner"><button class="umodal__close"></button><div class="umodal__content"></div></div></div>').appendTo("body").hide().fadeIn(200);var u=$(".umodal .umodal__content");if(null!=d&&null!=d){$(".umodal").removeClass("umodal_loading");var i=$($('[umodal-id="'+d+'"]:not(.umodal__open)').parents()[0]);$('[umodal-id="'+d+'"]:not(.umodal__open)').appendTo(u),$(".umodal__close").click(function(){$(".umodal").fadeOut(200,function(){$(".umodal__content [umodal-id]").appendTo(i),$(this).remove()}),o()})}else null==e?($(".umodal").addClass("umodal_inverse umodal_image"),u.html('<img src="'+t+'" class="umodal__image">'),$(".umodal__image").on("load",function(){$(this).addClass("umodal__image_show"),setTimeout(function(){$(".umodal").removeClass("umodal_loading")},30),$(window).resize()}),$(".umodal__image").on("error",function(){u.html("Не удалось загрузить изображение").fadeIn(200),$(".umodal").removeClass("umodal_loading")})):null!=n?u.hide().load(e+" "+n,function(o,l,a){"error"==l&&$(this).html("Не удалось загрузить содержимое: "+a.status+" "+a.statusText),$(this).fadeIn(200),setTimeout(function(){$(".umodal").removeClass("umodal_loading")},30)}):(u.hide(),$.ajax({url:e,type:"GET",success:function(o){var l=o.replace(/\r\n|\r|\n/g,"").match("<body[^>]*>(.*?)</body>")[0];u.html(l).fadeIn(200),setTimeout(function(){$(".umodal").removeClass("umodal_loading")},30)},error:function(o){u.html("Не удалось загрузить содержимое").fadeIn(200),setTimeout(function(){$(".umodal").removeClass("umodal_loading")},30)}})),$(".umodal .umodal__close").click(function(){$(".umodal").fadeOut(200,function(){$(this).remove()}),o()});setTimeout(function(){for(var o=$(".umodal__inner *").length;o>-1;o--)"auto"==$($(".umodal__inner *")[o]).css("overflow")&&$($(".umodal__inner *")[o]).addClass("umodal__item-scrollable");$("body").on("touchmove",function(o){$(this).hasClass("umodal-disable-scroll")&&o.preventDefault()}),$(".umodal-disable-scroll").on("touchstart",".umodal__item-scrollable",function(o){0===o.currentTarget.scrollTop?o.currentTarget.scrollTop=1:o.currentTarget.scrollHeight===o.currentTarget.scrollTop+o.currentTarget.offsetHeight&&(o.currentTarget.scrollTop-=1)}),$(".umodal-disable-scroll").on("touchmove",".umodal__item-scrollable",function(o){o.stopPropagation()})},200),$(".umodal__close").attr("title","[Esc]"),$(document).keyup(function(o){27===o.keyCode&&$(".umodal .umodal__close").click()})})});
